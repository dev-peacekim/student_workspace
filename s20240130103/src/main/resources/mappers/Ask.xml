<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.blackberry.s20240130103.yhs.AskMapper">
    
    <select id="askTotal"  resultType="int">
		SELECT Count(*) FROM BOARD_ADMIN
   </select>
	
   <select id="yhsAskListAll" parameterType="Ask" resultType="Ask">
     <![CDATA[
		SELECT *
		FROM
		(				
				SELECT rownum rn, a.*
				FROM ( SELECT ba.*, u.user_name, u.user_nic
  				FROM BOARD_ADMIN ba
  				INNER JOIN users u ON ba.user_no = u.user_no
  				WHERE ba.ADMIN_REPLY_CHK = 0
  				AND (ba.user_no = #{user_no} OR ba.user_no = #{user_no})
  				ORDER BY ADMIN_date DESC
		) a
						 
		)
		WHERE  rn  >= #{start} 
 		and    rn  <= #{end}    
 	 ]]>		
   </select>
   
   <select id="yhsAskListSearch" parameterType="Ask"
		resultType="Ask">
		SELECT *
		FROM (
		SELECT rownum rn, a.*
		FROM (
		SELECT ba.*, u.user_nic
		FROM BOARD_ADMIN ba, users u
		WHERE ba.user_no = u.user_no
		AND (ADMIN_TITLE LIKE '%' || #{keyword} || '%'
 		AND ADMIN_CONTENT LIKE '%' || #{keyword} || '%'
 		OR user_nic LIKE '%' || #{keyword} || '%' )
		) a
		)
<!-- 		WHERE rn BETWEEN #{start} AND #{end} -->
	</select>
   
   <select id="yhsAskContent" parameterType="String"
		resultType="Ask">
		SELECT ba.*, u.USER_NIC
		FROM BOARD_ADMIN ba
		INNER JOIN USERS u ON ba.USER_NO = u.USER_NO
		WHERE ba.admin_title = #{admin_title}
	</select>
	
	
	<insert id="yhsaskForm" parameterType="String"> 
			INSERT  INTO BOARD_COMM bc VALUES
	(
	seq_board_comm.nextval,
	#{CBOARD_TITLE},
	#{CBOARD_CONTENT},
	0,
	sysdate,
	#{USER_NO}
	0,
	300,
	20,
	NULL,
	NULL,
	sysdate
	)		
	</insert>
    
</mapper>