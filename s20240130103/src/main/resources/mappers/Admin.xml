<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.blackberry.s20240130103.lhs.Admin">
    <select id="LhsAdminCntMapget"  resultType="java.util.HashMap">
		SELECT u.all_user_cnt,p.all_project_cnt,bcr.all_coment_cnt,bc.all_board_cnt,tu.today_user_cnt,tp.today_project_cnt,tbcr.today_coment_cnt,tbc.today_board_cnt
				FROM (SELECT count(*) all_project_cnt FROM PROJECT p WHERE p.PROJECT_DELETE_CHK =0) p,
				(SELECT count(*) all_user_cnt FROM users u WHERE u.USER_DELETE_CHK = 0) u,
				(SELECT count(*) all_coment_cnt FROM BOARD_COMM_REPLY bcr WHERE BCR.CREPLY_DELETE_CHK = 0) bcr,
				(SELECT count(*) all_board_cnt FROM BOARD_COMM bc WHERE bc.CBOARD_DELETE_CHK = 0) bc,
			    (select count(*) today_user_cnt from users u where u.user_delete_chk=0 and TRUNC(u.user_date) = TRUNC(SYSDATE)) tu,
			    (select count(*) today_project_cnt from project p where p.project_delete_chk=0 and TRUNC(p.project_date) = TRUNC(SYSDATE)) tp,
			    (select count(*) today_coment_cnt from BOARD_COMM_REPLY bcr where bcr.creply_delete_chk=0 and TRUNC(bcr.creply_date) = TRUNC(SYSDATE)) tbcr,
			    (select count(*) today_board_cnt FROM BOARD_COMM bc where bc.cboard_delete_chk=0 and TRUNC(bc.cboard_date) = TRUNC(SYSDATE)) tbc
	</select>
	<select id="LhsAdminJoinUserCnt5day" resultType="java.util.HashMap">
		<![CDATA[
	    SELECT TRUNC(a.day) AS day, NVL(COUNT(u.user_date), 0) user_cnt
		FROM (SELECT TRUNC(SYSDATE - LEVEL) AS day FROM DUAL CONNECT BY LEVEL <= 5) a
		LEFT JOIN USERS u ON TRUNC(u.user_date) = a.day AND u.USER_DELETE_CHK = 0
		GROUP BY TRUNC(a.day)
		ORDER BY TRUNC(a.day) DESC
	    ]]>
	</select>
	
</mapper>